<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
			integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
			crossorigin="anonymous"
		/>
		<link rel="stylesheet" href="css/style.css" />
		<title>Chat App</title>
	</head>
	<body>
		<div class="join-container">
		<header class="join-header">
			<h1><i class="fas fa-smile"></i> Chat</h1>
			<button id="theme-toggle" class="theme-toggle" title="Toggle theme">
				<i class="fas fa-moon" id="theme-icon"></i>
			</button>
		</header>
			<main class="join-main">
				<form action="chat.html">
					<div class="form-control">
						<label for="username">Username</label>
						<input
							type="text"
							name="username"
							id="username"
							placeholder="Enter username..."
							required
							maxlength="20"
							pattern=".{1,20}"
							title="Username must be 1-20 characters"
						/>
						<small class="form-hint">Username must be unique and 1-20 characters</small>
					</div>
					<div class="form-control">
                        <label for="room">Room</label>
                        <input
                            type="text"
                            name="room"
                            id="room"
                            placeholder="Select or create a room..."
                            required
                            list="room-suggestions" 
                        />
                        <datalist id="room-suggestions">
                            <option value="Thai"></option>
                            <option value="USA"></option>
                            <option value="China"></option>
                            <option value="Chula"></option>
                        </datalist>
                    </div>
					<button type="submit" class="btn">Join Chat</button>
				</form>
			</main>
		</div>
		<script>
			// Client-side validation
			const form = document.querySelector('form');
			const usernameInput = document.getElementById('username');
			
			form.addEventListener('submit', (e) => {
				const username = usernameInput.value.trim();
				
				// Validate username
				if (!username) {
					e.preventDefault();
					alert('Username is required');
					return false;
				}
				
				if (username.length > 20) {
					e.preventDefault();
					alert('Username must be 20 characters or less');
					return false;
				}
				
				if (username.includes('  ')) {
					e.preventDefault();
					alert('Username cannot contain consecutive spaces');
					return false;
				}
				
				// Validate room
				const room = document.getElementById('room').value.trim();
				if (!room) {
					e.preventDefault();
					alert('Room is required');
					return false;
				}
			});
			
			// Real-time validation feedback
			usernameInput.addEventListener('input', (e) => {
				const value = e.target.value.trim();
				if (value.length > 20) {
					e.target.setCustomValidity('Username must be 20 characters or less');
				} else {
					e.target.setCustomValidity('');
				}
			});
		</script>
		<script>
			// Theme toggle functionality
			const themeToggle = document.getElementById('theme-toggle');
			const themeIcon = document.getElementById('theme-icon');
			const html = document.documentElement;
			
			// Get saved theme or default to light
			const currentTheme = localStorage.getItem('theme') || 'light';
			html.setAttribute('data-theme', currentTheme);
			updateIcon(currentTheme);
			
			// Toggle theme
			themeToggle.addEventListener('click', () => {
				const currentTheme = html.getAttribute('data-theme');
				const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
				html.setAttribute('data-theme', newTheme);
				localStorage.setItem('theme', newTheme);
				updateIcon(newTheme);
			});
			
			function updateIcon(theme) {
				if (theme === 'dark') {
					themeIcon.classList.remove('fa-moon');
					themeIcon.classList.add('fa-sun');
				} else {
					themeIcon.classList.remove('fa-sun');
					themeIcon.classList.add('fa-moon');
				}
			}
		</script>
	</body>
</html>